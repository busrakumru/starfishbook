<ion-header>
  <ion-toolbar>
    <ion-button size="small" fill="clear" (click)="saveTodo(newTodo)">
      <ion-icon slot="icon-only" name="checkmark-outline"></ion-icon>
    </ion-button>
    <ion-button size="small" fill="clear" (click)="abbrechen()">
      <ion-icon slot="icon-only" name="close-outline"></ion-icon>
    </ion-button>
  </ion-toolbar>
</ion-header>

<ion-content>
  <div class="form">
    <div>
      <form #todoForm="ngForm">
        <section>
          <div class="ion-padding-top">
            <div class="ion-padding-top" *ngIf="!show">
              <mat-form-field [hideRequiredMarker]="true">
                <input matInput [placeholder]="placeholderTitel" [(ngModel)]="newTodo.title" id="title" type="text"
                  required name="title" #title="ngModel">
              </mat-form-field>
            </div>
            <div *ngIf="show">
              <mat-form-field [hideRequiredMarker]="true" *ngIf="title">
                <input matInput value="{{title}}" [(ngModel)]="editingTodo.title" type="text" required
                  name="editingtitle" #editingtitle="ngModel">
              </mat-form-field>
            </div>
            <ion-item id="date">
              <ion-label>Dateline</ion-label>
              <ion-text slot="end">
                {{newTodo.appointmentTime | date: 'dd.MM.yyyy' }}
              </ion-text>
            </ion-item>
            <ion-popover trigger="date" size="cover">
              <ng-template>
                <ion-datetime presentation="date" name="date" [min]="minDate" [max]="maxDate"
                  [(ngModel)]="newTodo.appointmentTime" locale="de-DE"></ion-datetime>
              </ng-template>
            </ion-popover>
            <div>
              <mat-form-field [hideRequiredMarker]="true">
                <input matInput placeholder="Todos erstellen" type="text" id="text" class="form-control" required
                  name="text" [(ngModel)]="newTodolist.text" #text="ngModel">
              </mat-form-field>
            </div>
          </div>
        </section>
        <ion-button class="save" size="small" (click)="createTodolist()">
          Todo speichern
        </ion-button>
      </form>
    </div>
    <div>
      <div *ngFor="let todo of todolist" [class.finished]="todo.finised === true">
        <div *ngIf="!editing || editingTodolist.id != todo.id" class="todo-list">
          <a>
            <ion-checkbox [(ngModel)]="todo.finished" (click)="toggleCompleted(todo)" class="material-icons">
            </ion-checkbox>
          </a>
          <span class="todo-text">
            {{todo.text}}
          </span>
          <span class="todo-actions">
            <a (click)="editTodolist(todo)">
              <i class="material-icons">edit</i>
            </a>
            <a (click)="deleteTodolist(todo.id)">
              <i class="material-icons">clear</i>
            </a>
          </span>
        </div>
        <div class="todo-edit" *ngIf="editing && editingTodolist.id === todo.id">
          <div>
            <mat-form-field style=" width: 120%;">
              <input matInput type="text" [(ngModel)]="editingTodolist.text" required>
            </mat-form-field>
          </div>
          <span>
            <a (click)="updateTodolist(editingTodolist)">
              <i class="material-icons">done</i>
            </a>
            <a (click)="clearEditing()">
              <i class="material-icons">clear</i>
            </a>
          </span>
        </div>
      </div>
    </div>
  </div>
</ion-content>